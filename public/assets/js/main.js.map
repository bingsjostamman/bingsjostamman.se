{"version":3,"file":"main.js","sources":["../../../src/js/helpers/dom.js","../../../src/_includes/components/menu/menu.js","../../../src/js/controllers/modal.js","../../../src/js/controllers/accordion.js","../../../src/js/main.js"],"sourcesContent":["// helpers/dom.js\nexport const qs = (sel, parent = document) => parent.querySelector(sel);\nexport const qsa = (sel, parent = document) => [\n  ...parent.querySelectorAll(sel),\n];\n","// src/_includes/components/menu/menu.js\nimport { qs } from \"../../../js/helpers/dom.js\"; // update path as needed\n\n/**\n * Enhances a static menu include:\n * - Converts <a[data-menu-toggle]> -> <button>\n * - Adds ARIA attributes\n * - Toggle open/close with animation via data-open\n * - Focus trap: tab cycles through links and the toggle button\n * - ESC closes, backdrop & click-outside close\n * - Progressive: no aria attributes left in static HTML\n */\nexport function initMenu(root = document) {\n  const link = qs(\"[data-menu-toggle]\", root);\n  const nav = qs(\"[data-menu-panel]\", root);\n  const backdrop = qs(\".menu-backdrop\", root);\n\n  if (!link || !nav || !backdrop) return;\n\n  // mark JS active for CSS\n  document.documentElement.setAttribute(\"data-js\", \"\");\n\n  // Create a button and replace the fallback link\n  const btn = document.createElement(\"button\");\n  btn.className = link.className || \"\";\n  btn.innerHTML = link.innerHTML;\n  btn.setAttribute(\"data-menu-toggle\", \"\");\n  link.replaceWith(btn);\n\n  // ARIA + attributes\n  btn.setAttribute(\"aria-expanded\", \"false\");\n  btn.setAttribute(\"aria-controls\", nav.id);\n  // aria-haspopup optional for simple panel; harmless if present\n  // btn.setAttribute(\"aria-haspopup\", \"true\");\n\n  // initial hidden state (JS controls visibility)\n  nav.hidden = true;\n  backdrop.hidden = true;\n  nav.dataset.open = \"false\";\n  backdrop.dataset.open = \"false\";\n\n  let previouslyFocused = null;\n  const links = () => Array.from(nav.querySelectorAll(\"a[href]\")); // only links in the panel\n\n  // reduced motion check to decide hide timing\n  const reduceMotion = window.matchMedia(\n    \"(prefers-reduced-motion: reduce)\"\n  ).matches;\n  const animationDelay = reduceMotion ? 0 : 300;\n\n  function openMenu() {\n    previouslyFocused = document.activeElement;\n\n    nav.hidden = false;\n    backdrop.hidden = false;\n\n    nav.dataset.open = \"true\";\n    backdrop.dataset.open = \"true\";\n    btn.setAttribute(\"aria-expanded\", \"true\");\n\n    // Move focus to first link for natural Tab navigation\n    const first = links()[0];\n    //    if (first) first.focus();\n  }\n\n  function closeMenu() {\n    nav.dataset.open = \"false\";\n    backdrop.dataset.open = \"false\";\n    btn.setAttribute(\"aria-expanded\", \"false\");\n\n    // wait for animation to finish before hiding fully\n    setTimeout(() => {\n      if (nav.dataset.open === \"false\") {\n        nav.hidden = true;\n        backdrop.hidden = true;\n      }\n    }, animationDelay);\n\n    // restore focus to the element that opened the menu\n    if (previouslyFocused && previouslyFocused.focus) {\n      previouslyFocused.focus();\n    }\n  }\n\n  btn.addEventListener(\"click\", (e) => {\n    const isOpen = nav.dataset.open === \"true\";\n    if (isOpen) {\n      closeMenu();\n    } else {\n      openMenu();\n    }\n  });\n\n  // ESC closes (listen on document so it works anywhere)\n  document.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Escape\" && nav.dataset.open === \"true\") {\n      closeMenu();\n    }\n  });\n\n  // Focus trap behavior:\n  // The trap includes the toggle button â€” Tab cycles: first link -> ... -> last link -> button -> first link.\n  // Shift+Tab cycles backwards: button -> last link -> ... -> first link -> button.\n  document.addEventListener(\"keydown\", (e) => {\n    if (e.key !== \"Tab\" || nav.dataset.open !== \"true\") return;\n\n    const currentLinks = links();\n    if (currentLinks.length === 0) {\n      // If there are no links, trap focus between btn and btn (i.e., keep focusable on btn)\n      e.preventDefault();\n      btn.focus();\n      return;\n    }\n\n    const first = currentLinks[0];\n    const last = currentLinks[currentLinks.length - 1];\n    const active = document.activeElement;\n\n    // If focused on the last link and user TABs forward -> move to button\n    if (!e.shiftKey && active === last) {\n      e.preventDefault();\n      btn.focus();\n      return;\n    }\n\n    // If focused on the button and user TABs forward -> move to first link\n    if (!e.shiftKey && active === btn) {\n      e.preventDefault();\n      first.focus();\n      return;\n    }\n\n    // If focused on the first link and user SHIFT+TAB -> move to button\n    if (e.shiftKey && active === first) {\n      e.preventDefault();\n      btn.focus();\n      return;\n    }\n\n    // If focused on the button and user SHIFT+TAB -> move to last link\n    if (e.shiftKey && active === btn) {\n      e.preventDefault();\n      last.focus();\n      return;\n    }\n\n    // otherwise let the browser handle tabbing between links naturally\n  });\n\n  // Backdrop click closes\n  backdrop.addEventListener(\"click\", closeMenu);\n\n  // Click outside closes menu\n  document.addEventListener(\"click\", (e) => {\n    if (nav.dataset.open !== \"true\") return;\n    // if click target is within the root component, ignore (this includes btn)\n    if (root.contains(e.target)) return;\n    closeMenu();\n  });\n\n  // Optional: ensure focus remains inside when clicking into the panel (no-op but helpful)\n  nav.addEventListener(\"focusout\", (e) => {\n    // no special handling here since we manage tab key behavior above\n  });\n}\n","// controllers/modal.js\nimport { qs } from \"../helpers/dom.js\";\n\nexport function initModal(root) {\n  const dialog = qs(\"dialog\", root);\n  const openBtn = qs(\"[data-modal-open]\", root);\n  const closeBtn = qs(\"[data-modal-close]\", root) || qs(\"button\", dialog);\n\n  if (!dialog || !openBtn) return;\n\n  openBtn.addEventListener(\"click\", () => {\n    dialog.showModal?.() ?? dialog.setAttribute(\"open\", \"\");\n  });\n\n  closeBtn?.addEventListener(\"click\", () => {\n    dialog.close?.() ?? dialog.removeAttribute(\"open\");\n  });\n\n  dialog.addEventListener(\"click\", (e) => {\n    const rect = dialog.getBoundingClientRect();\n    const inDialog =\n      e.clientX >= rect.left &&\n      e.clientX <= rect.right &&\n      e.clientY >= rect.top &&\n      e.clientY <= rect.bottom;\n\n    if (!inDialog) dialog.close?.();\n  });\n}\n","// controllers/accordion.js\nimport { qsa } from \"../helpers/dom.js\";\n\nexport function initAccordion(root) {\n  //  console.log(\"JS initialized for sure, yeah!\");\n  const items = qsa(\"[data-accordion-item]\", root);\n\n  items.forEach((item) => {\n    const header = item.querySelector(\"[data-accordion-header]\");\n    const panel = item.querySelector(\"[data-accordion-panel]\");\n\n    header.addEventListener(\"click\", () => {\n      const isOpen = item.classList.contains(\"is-open\");\n      item.classList.toggle(\"is-open\", !isOpen);\n      panel.hidden = isOpen;\n    });\n\n    // closed by default\n    panel.hidden = true;\n  });\n}\n","// main.js\nimport { initMenu } from \"../_includes/components/menu/menu.js\";\n\nimport { initModal } from \"./controllers/modal.js\";\nimport { initAccordion } from \"./controllers/accordion.js\";\n\n// Import entry.css so Vite processes it\nimport \"../css/entry.css\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document.querySelectorAll(\"[data-modal]\").forEach((el) => initModal(el));\n  document\n    .querySelectorAll(\"[data-accordion]\")\n    .forEach((el) => initAccordion(el));\n  document.querySelectorAll(\"[data-menu]\").forEach((el) => initMenu(el));\n});\n"],"names":[],"mappings":";AACO,MAAM,KAAK,CAAC,KAAK,SAAS,aAAa,OAAO,cAAc,GAAG;AAC/D,MAAM,MAAM,CAAC,KAAK,SAAS,aAAa;AAAA,EAC7C,GAAG,OAAO,iBAAiB,GAAG;AAChC;ACQO,SAAS,SAAS,OAAO,UAAU;AACxC,QAAM,OAAO,GAAG,sBAAsB,IAAI;AAC1C,QAAM,MAAM,GAAG,qBAAqB,IAAI;AACxC,QAAM,WAAW,GAAG,kBAAkB,IAAI;AAE1C,MAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAU;AAGhC,WAAS,gBAAgB,aAAa,WAAW,EAAE;AAGnD,QAAM,MAAM,SAAS,cAAc,QAAQ;AAC3C,MAAI,YAAY,KAAK,aAAa;AAClC,MAAI,YAAY,KAAK;AACrB,MAAI,aAAa,oBAAoB,EAAE;AACvC,OAAK,YAAY,GAAG;AAGpB,MAAI,aAAa,iBAAiB,OAAO;AACzC,MAAI,aAAa,iBAAiB,IAAI,EAAE;AAKxC,MAAI,SAAS;AACb,WAAS,SAAS;AAClB,MAAI,QAAQ,OAAO;AACnB,WAAS,QAAQ,OAAO;AAExB,MAAI,oBAAoB;AACxB,QAAM,QAAQ,MAAM,MAAM,KAAK,IAAI,iBAAiB,SAAS,CAAC;AAG9D,QAAM,eAAe,OAAO;AAAA,IAC1B;AAAA,EACJ,EAAI;AACF,QAAM,iBAAiB,eAAe,IAAI;AAE1C,WAAS,WAAW;AAClB,wBAAoB,SAAS;AAE7B,QAAI,SAAS;AACb,aAAS,SAAS;AAElB,QAAI,QAAQ,OAAO;AACnB,aAAS,QAAQ,OAAO;AACxB,QAAI,aAAa,iBAAiB,MAAM;AAG1B,UAAK,EAAG,CAAC;AAAA,EAEzB;AAEA,WAAS,YAAY;AACnB,QAAI,QAAQ,OAAO;AACnB,aAAS,QAAQ,OAAO;AACxB,QAAI,aAAa,iBAAiB,OAAO;AAGzC,eAAW,MAAM;AACf,UAAI,IAAI,QAAQ,SAAS,SAAS;AAChC,YAAI,SAAS;AACb,iBAAS,SAAS;AAAA,MACpB;AAAA,IACF,GAAG,cAAc;AAGjB,QAAI,qBAAqB,kBAAkB,OAAO;AAChD,wBAAkB,MAAK;AAAA,IACzB;AAAA,EACF;AAEA,MAAI,iBAAiB,SAAS,CAAC,MAAM;AACnC,UAAM,SAAS,IAAI,QAAQ,SAAS;AACpC,QAAI,QAAQ;AACV,gBAAS;AAAA,IACX,OAAO;AACL,eAAQ;AAAA,IACV;AAAA,EACF,CAAC;AAGD,WAAS,iBAAiB,WAAW,CAAC,MAAM;AAC1C,QAAI,EAAE,QAAQ,YAAY,IAAI,QAAQ,SAAS,QAAQ;AACrD,gBAAS;AAAA,IACX;AAAA,EACF,CAAC;AAKD,WAAS,iBAAiB,WAAW,CAAC,MAAM;AAC1C,QAAI,EAAE,QAAQ,SAAS,IAAI,QAAQ,SAAS,OAAQ;AAEpD,UAAM,eAAe,MAAK;AAC1B,QAAI,aAAa,WAAW,GAAG;AAE7B,QAAE,eAAc;AAChB,UAAI,MAAK;AACT;AAAA,IACF;AAEA,UAAM,QAAQ,aAAa,CAAC;AAC5B,UAAM,OAAO,aAAa,aAAa,SAAS,CAAC;AACjD,UAAM,SAAS,SAAS;AAGxB,QAAI,CAAC,EAAE,YAAY,WAAW,MAAM;AAClC,QAAE,eAAc;AAChB,UAAI,MAAK;AACT;AAAA,IACF;AAGA,QAAI,CAAC,EAAE,YAAY,WAAW,KAAK;AACjC,QAAE,eAAc;AAChB,YAAM,MAAK;AACX;AAAA,IACF;AAGA,QAAI,EAAE,YAAY,WAAW,OAAO;AAClC,QAAE,eAAc;AAChB,UAAI,MAAK;AACT;AAAA,IACF;AAGA,QAAI,EAAE,YAAY,WAAW,KAAK;AAChC,QAAE,eAAc;AAChB,WAAK,MAAK;AACV;AAAA,IACF;AAAA,EAGF,CAAC;AAGD,WAAS,iBAAiB,SAAS,SAAS;AAG5C,WAAS,iBAAiB,SAAS,CAAC,MAAM;AACxC,QAAI,IAAI,QAAQ,SAAS,OAAQ;AAEjC,QAAI,KAAK,SAAS,EAAE,MAAM,EAAG;AAC7B,cAAS;AAAA,EACX,CAAC;AAGD,MAAI,iBAAiB,YAAY,CAAC,MAAM;AAAA,EAExC,CAAC;AACH;ACjKO,SAAS,UAAU,MAAM;AAC9B,QAAM,SAAS,GAAG,UAAU,IAAI;AAChC,QAAM,UAAU,GAAG,qBAAqB,IAAI;AAC5C,QAAM,WAAW,GAAG,sBAAsB,IAAI,KAAK,GAAG,UAAU,MAAM;AAEtE,MAAI,CAAC,UAAU,CAAC,QAAS;AAEzB,UAAQ,iBAAiB,SAAS,MAAM;AACtC,WAAO,YAAS,KAAQ,OAAO,aAAa,QAAQ,EAAE;AAAA,EACxD,CAAC;AAED,YAAU,iBAAiB,SAAS,MAAM;AACxC,WAAO,QAAK,KAAQ,OAAO,gBAAgB,MAAM;AAAA,EACnD,CAAC;AAED,SAAO,iBAAiB,SAAS,CAAC,MAAM;AACtC,UAAM,OAAO,OAAO,sBAAqB;AACzC,UAAM,WACJ,EAAE,WAAW,KAAK,QAClB,EAAE,WAAW,KAAK,SAClB,EAAE,WAAW,KAAK,OAClB,EAAE,WAAW,KAAK;AAEpB,QAAI,CAAC,SAAU,QAAO,QAAK;AAAA,EAC7B,CAAC;AACH;ACzBO,SAAS,cAAc,MAAM;AAElC,QAAM,QAAQ,IAAI,yBAAyB,IAAI;AAE/C,QAAM,QAAQ,CAAC,SAAS;AACtB,UAAM,SAAS,KAAK,cAAc,yBAAyB;AAC3D,UAAM,QAAQ,KAAK,cAAc,wBAAwB;AAEzD,WAAO,iBAAiB,SAAS,MAAM;AACrC,YAAM,SAAS,KAAK,UAAU,SAAS,SAAS;AAChD,WAAK,UAAU,OAAO,WAAW,CAAC,MAAM;AACxC,YAAM,SAAS;AAAA,IACjB,CAAC;AAGD,UAAM,SAAS;AAAA,EACjB,CAAC;AACH;ACXA,SAAS,iBAAiB,oBAAoB,MAAM;AAClD,WAAS,iBAAiB,cAAc,EAAE,QAAQ,CAAC,OAAO,UAAU,EAAE,CAAC;AACvE,WACG,iBAAiB,kBAAkB,EACnC,QAAQ,CAAC,OAAO,cAAc,EAAE,CAAC;AACpC,WAAS,iBAAiB,aAAa,EAAE,QAAQ,CAAC,OAAO,SAAS,EAAE,CAAC;AACvE,CAAC;"}